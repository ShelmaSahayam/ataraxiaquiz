<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ataraxia Realm Quiz</title>
  <!-- Google Fonts for Cinzel and Lora -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lora:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
  <!-- html2canvas CDN for Instagram sharing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      font-family: 'Lora', serif;
      background: linear-gradient(135deg, #1a1a3d, #2a2a5e);
      color: #e2e8f0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0;
      overflow-x: hidden;
    }
    .cursor-quill {
      cursor: url('https://shelmasahayam.github.io/ataraxiaquiz/assets/quill-cursor.png'), auto;
    }
    #result-card {
      background: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      padding: 20px;
      max-width: 540px;
      margin: 0 auto;
    }
    #sib-container input:-ms-input-placeholder {
      text-align: left;
      font-family: 'Lora', serif;
      color: #c0ccda;
    }
    #sib-container input::placeholder {
      text-align: left;
      font-family: 'Lora', serif;
      color: #c0ccda;
    }
    #sib-container a {
      text-decoration: underline;
      color: #f59e0b;
    }
    #error-message, #success-message {
      font-family: 'Lora', serif;
      font-size: 16px;
      text-align: center;
      color: #661d1d;
      background-color: #ffeded;
      border-radius: 3px;
      border: 1px solid #ff4949;
      max-width: 540px;
      margin: 0 auto;
      padding: 8px;
    }
    #success-message {
      color: #085229;
      background-color: #e7faf0;
      border-color: #13ce66;
    }
    .quiz-container {
      text-align: center;
      padding: 24px;
      max-width: 540px;
      margin: 0 auto;
    }
    .progress-bar {
      width: 100%;
      max-width: 400px;
      margin: 16px auto;
      background-color: #4b5563;
      height: 8px;
      border-radius: 9999px;
    }
    .progress-bar-fill {
      background-color: #f59e0b;
      height: 8px;
      border-radius: 9999px;
      transition: width 0.3s ease-in-out;
    }
    .question-text {
      font-size: 24px;
      color: #e2e8f0;
      margin-bottom: 24px;
    }
    .option-button {
      background-color: #1f2937;
      color: #e2e8f0;
      padding: 12px 24px;
      border-radius: 8px;
      border: none;
      width: 100%;
      margin-bottom: 16px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .option-button:hover {
      background-color: #374151;
    }
    .name-input {
      background-color: #1f2937;
      color: #e2e8f0;
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      width: 100%;
      max-width: 300px;
      margin-bottom: 16px;
      font-size: 16px;
    }
    .name-input::placeholder {
      color: #c0ccda;
      font-family: 'Lora', serif;
    }
    .submit-button {
      background-color: #f59e0b;
      color: #111827;
      padding: 8px 24px;
      border-radius: 9999px;
      border: none;
      font-family: 'Cinzel', serif;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .submit-button:hover {
      background-color: #fbbf24;
    }
    .error-text {
      color: #f87171;
      margin-bottom: 16px;
      font-size: 14px;
    }
    .share-button-x {
      background-color: #2563eb;
      color: #ffffff;
      padding: 8px 16px;
      border-radius: 9999px;
      border: none;
      font-family: 'Cinzel', serif;
      font-size: 14px;
      cursor: pointer;
      margin-right: 16px;
      transition: background-color 0.2s;
    }
    .share-button-x:hover {
      background-color: #3b82f6;
    }
    .share-button-instagram {
      background-color: #db2777;
      color: #ffffff;
      padding: 8px 16px;
      border-radius: 9999px;
      border: none;
      font-family: 'Cinzel', serif;
      font-size: 14px;
      cursor: pointer;
      margin-right: 16px;
      transition: background-color 0.2s;
    }
    .share-button-instagram:hover {
      background-color: #ec4899;
    }
    .button-container {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-bottom: 24px;
    }
    .title {
      font-family: 'Cinzel', serif;
      font-size: 36px;
      color: #f59e0b;
      margin-bottom: 32px;
    }
    .subtitle {
      font-family: 'Cinzel', serif;
      font-size: 24px;
      color: #f59e0b;
      margin-bottom: 16px;
    }
    .text-gray-300 {
      color: #d1d5db;
      margin-bottom: 24px;
      font-size: 16px;
    }
    .result-text {
      font-size: 20px;
      color: #e2e8f0;
      margin-bottom: 24px;
    }
  </style>
  <link rel="stylesheet" href="https://sibforms.com/forms/end-form/build/sib-styles.css">
</head>
<body>
  <div id="root"></div>
  <!-- React and ReactDOM CDNs -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script type="text/javascript">
    const questions = [
      {
        id: 1,
        text: "You stand at the edge of Nesrin’s aetheric plains, where elemental energies swirl in the air. How do you prefer to spend your day?",
        options: [
          { text: "Exploring the vibrant markets, connecting with others amidst the hum of modern life.", value: "E" },
          { text: "Retreating to a quiet corner of a modern home, reflecting on the flow of aether.", value: "I" },
        ],
        dimension: "EI",
      },
      {
        id: 2,
        text: "In Sorin’s Academy, you’re tasked with solving a complex aetheric puzzle. How do you approach it?",
        options: [
          { text: "Focus on the tangible components, testing each part methodically.", value: "S" },
          { text: "Imagine the possibilities, seeking patterns in the aether’s flow.", value: "N" },
        ],
        dimension: "SN",
      },
      {
        id: 3,
        text: "A dispute arises in Nagam among the reptilian folk. How do you resolve it?",
        options: [
          { text: "Analyze the situation logically, proposing a fair solution based on facts.", value: "T" },
          { text: "Consider the emotions and values of all involved, seeking harmony.", value: "F" },
        ],
        dimension: "TF",
      },
      {
        id: 4,
        text: "In Kural’s vast library of aetheric knowledge, how do you organize your studies?",
        options: [
          { text: "Create a structured plan, following a strict schedule to cover all scrolls.", value: "J" },
          { text: "Dive in spontaneously, exploring texts as inspiration strikes.", value: "P" },
        ],
        dimension: "JP",
      },
      {
        id: 5,
        text: "In Aceso’s lush forests, a beast tamer invites you to join a hunt. How do you respond?",
        options: [
          { text: "Eagerly join the group, energized by the shared adventure.", value: "E" },
          { text: "Prefer to observe the beasts alone, studying their natura aether in solitude.", value: "I" },
        ],
        dimension: "EI",
      },
      {
        id: 6,
        text: "Harmaa’s dark ravines glow with abrogation aether. How do you navigate its mysteries?",
        options: [
          { text: "Trust your senses, mapping the canals with practical steps.", value: "S" },
          { text: "Rely on intuition, sensing the hidden currents of aether.", value: "N" },
        ],
        dimension: "SN",
      },
      {
        id: 7,
        text: "In Cozen’s desolate canyons, an odium offers you a deal. How do you decide?",
        options: [
          { text: "Weigh the pros and cons objectively, focusing on outcomes.", value: "T" },
          { text: "Listen to your heart, considering your values and their intentions.", value: "F" },
        ],
        dimension: "TF",
      },
      {
        id: 8,
        text: "On the Niji Archipelagoes, where rules are few, how do you approach a festival?",
        options: [
          { text: "Plan your activities, ensuring you experience key events.", value: "J" },
          { text: "Embrace the chaos, letting the moment guide your choices.", value: "P" },
        ],
        dimension: "JP",
      },
      {
        id: 9,
        text: "In Niran, suspended above Sorin, time creatures offer you a vision of the future. How do you react?",
        options: [
          { text: "Engage with them openly, eager to share and learn.", value: "E" },
          { text: "Reflect quietly, processing the vision in your mind.", value: "I" },
        ],
        dimension: "EI",
      },
      {
        id: 10,
        text: "In Ascian, among the manes, you uncover an ancient relic. How do you study it?",
        options: [
          { text: "Examine its physical details, cataloging its properties.", value: "S" },
          { text: "Ponder its symbolic meaning, imagining its historical significance.", value: "N" },
        ],
        dimension: "SN",
      },
      {
        id: 11,
        text: "In Nesrin, a conflict requires a leader. How do you make your decision?",
        options: [
          { text: "Base it on logical analysis, prioritizing efficiency.", value: "T" },
          { text: "Consider the community’s values, aiming for unity.", value: "F" },
        ],
        dimension: "TF",
      },
      {
        id: 12,
        text: "In Sorin’s Academy, you’re planning a research expedition. How do you prepare?",
        options: [
          { text: "Organize a detailed itinerary, ensuring all resources are ready.", value: "J" },
          { text: "Keep plans flexible, ready to adapt to new discoveries.", value: "P" },
        ],
        dimension: "JP",
      },
      {
        id: 13,
        text: "In Harmaa’s canals, you encounter a group of travelers. How do you interact?",
        options: [
          { text: "Join them enthusiastically, sharing stories under the eternal night.", value: "E" },
          { text: "Observe from a distance, preferring your own thoughts.", value: "I" },
        ],
        dimension: "EI",
      },
      {
        id: 14,
        text: "In Aceso, you’re tasked with taming a wild beast. How do you approach it?",
        options: [
          { text: "Use practical techniques, observing its behavior closely.", value: "S" },
          { text: "Trust your instincts to sense its natura aether.", value: "N" },
        ],
        dimension: "SN",
      },
      {
        id: 15,
        text: "In Kural, a spectre asks for your help preserving a scroll. How do you decide?",
        options: [
          { text: "Evaluate the scroll’s importance based on knowledge.", value: "T" },
          { text: "Consider the spectre’s emotional attachment to the scroll.", value: "F" },
        ],
        dimension: "TF",
      },
      {
        id: 16,
        text: "In Cozen, you face a Nether storm. How do you survive it?",
        options: [
          { text: "Follow a prepared plan, using shelter systematically.", value: "J" },
          { text: "Adapt on the fly, navigating the storm as it unfolds.", value: "P" },
        ],
        dimension: "JP",
      },
      {
        id: 17,
        text: "On the Niji Archipelagoes’ Mirage Islands, you encounter a mysterious figure. How do you engage?",
        options: [
          { text: "Approach them eagerly, seeking their story.", value: "E" },
          { text: "Keep to yourself, observing them quietly.", value: "I" },
        ],
        dimension: "EI",
      },
      {
        id: 18,
        text: "In Niran’s poesis aether, you create a time artifact. How do you create it?",
        options: [
          { text: "Focus on its practical function, ensuring it works reliably.", value: "S" },
          { text: "Incorporate symbolic elements, inspired by its potential.", value: "N" },
        ],
        dimension: "SN",
      },
      {
        id: 19,
        text: "In Nagam, a reptilian elder seeks your counsel. How do you advise them?",
        options: [
          { text: "Offer a solution based on objective reasoning.", value: "T" },
          { text: "Provide guidance based on cultural values.", value: "F" },
        ],
        dimension: "TF",
      },
      {
        id: 20,
        text: "In Ascian, you’re invited to a manes’ ritual. How do you participate?",
        options: [
          { text: "Plan your role carefully, respecting their traditions.", value: "J" },
          { text: "Join spontaneously, embracing the ritual’s flow.", value: "P" },
        ],
        dimension: "JP",
      }
    ];

    const realmMappings = {
      ENFJ: "Nesrin",
      ESTP: "Nesrin",
      ENTJ: "Sorin",
      ISTJ: "Sorin",
      INFJ: "Prisca",
      ESFP: "Niji Archipelagoes",
      INTJ: "Harmaa",
      INTP: "Harmaa",
      ENTP: "Aceso",
      ISFP: "Aceso",
      INFP: "Kural",
      ESFJ: "Kural",
      ENFP: "Cozen",
      ISFJ: "Niran",
      ESTJ: "Nagam",
      ISTP: "Ascian",
    };

    const realmDescriptions = {
      Nesrin: "A land of elemental aether, where modern houses blend with vibrant markets and swirling energies, Nesrin is home to those who thrive in connection and action.",
      Sorin: "At the heart of Ataraxia, Sorin hosts the prestigious Academy, a hub of knowledge and order, perfect for disciplined and ambitious souls.",
      Prisca: "A realm of introspection and wisdom, Prisca’s serene landscapes inspire those who seek deep understanding and harmony.",
      "Niji Archipelagoes": "A cluster of islands where rules are cast aside, the Niji Archipelagoes, with their mysterious Mirage Islands, attract free spirits and adventurers.",
      Harmaa: "Shrouded in perpetual night, Harmaa’s ravines and canals pulse with abrogation aether, drawing analytical and introspective minds.",
      Aceso: "Lush forests teeming with beasts and natura aether, Aceso is the haven of beast tamers and those who embrace the wild.",
      Kural: "A vast library of aetheric knowledge filled with spectres, Kural is the sanctuary for those who cherish wisdom and empathy.",
      Cozen: "A desolate land of canyons and nether, Cozen’s odiums challenge the resilient and imaginative who dare to thrive there.",
      Niran: "Floating above Sorin, Niran’s poesis aether and time creatures attract those who weave creativity and care into their lives.",
      Nagam: "Near Nesrin, Nagam’s reptilian people with scaled arms and eyes call to those who value structure and leadership.",
      Ascian: "A land of manes near Kural, Ascian beckons those who find freedom in solitude and practical ingenuity.",
    };

    const ProgressBar = ({ current, total }) => {
      return React.createElement(
        'div',
        { className: 'progress-bar' },
        React.createElement(
          'div',
          {
            className: 'progress-bar-fill',
            style: { width: `${(current / total) * 100}%` }
          }
        )
      );
    };

    const NameForm = ({ onSubmit }) => {
      const [name, setName] = React.useState('');
      const [email, setEmail] = React.useState('');
      const [error, setError] = React.useState(null);

      const handleSubmit = (e) => {
        e.preventDefault();
        if (!name || !/^[a-zA-Z\s]+$/.test(name.trim())) {
          setError('Please enter a valid name (letters and spaces only).');
          return;
        }
        if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          setError('Please enter a valid email.');
          return;
        }
        const form = document.getElementById('brevo-form');
        form.querySelector('input[name="EMAIL"]').value = email;
        form.submit();
        onSubmit(name.trim());
      };

      return React.createElement(
        'div',
        { className: 'quiz-container cursor-quill' },
        React.createElement('h2', { className: 'subtitle' }, 'Enter Your Details'),
        React.createElement('p', { className: 'text-gray-300' }, 'Provide your adventurer’s name and email to discover your Ataraxia realm.'),
        React.createElement(
          'div',
          { style: { display: 'flex', flexDirection: 'column', alignItems: 'center' } },
          React.createElement('input', {
            type: 'text',
            value: name,
            onChange: (e) => setName(e.target.value),
            placeholder: 'Enter your name',
            className: 'name-input',
            required: true
          }),
          React.createElement('input', {
            type: 'email',
            value: email,
            onChange: (e) => setEmail(e.target.value),
            placeholder: 'Enter your email',
            className: 'name-input',
            required: true
          }),
          error && React.createElement('p', { className: 'error-text' }, error),
          React.createElement('button', { onClick: handleSubmit, className: 'submit-button' }, 'See Your Realm')
        ),
        React.createElement(
          'form',
          {
            id: 'brevo-form',
            action: 'https://438a9235.sibforms.com/serve/MUIFAHIY2DfRgKzSVjeBG80hDx2l0Uq-tfDSYgsB3-Rool1s5GCUdziUZzvaEgB5V3l0SyY1wFAZ8VM0cw1ro0SZ_ZsYtP0uSbpHjzn7vDNEqE8Oiu7IABn6oldtyFUxl3Svv9a26l5hIJ2AADpoiSnXPoZt2a3TklMHF8iNeJ0av1ihA2Vh6KTJdhNG5mek4GVSoBjgohYJvC97',
            method: 'POST',
            style: { display: 'none' }
          },
          React.createElement('input', { type: 'text', name: 'EMAIL' }),
          React.createElement('input', { type: 'text', name: 'email_address_check', value: '' }),
          React.createElement('input', { type: 'hidden', name: 'locale', value: 'en' }),
          React.createElement('input', { type: 'hidden', name: 'html_type', value: 'simple' })
        )
      );
    };

    const Quiz = () => {
      const [currentQuestion, setCurrentQuestion] = React.useState(0);
      const [scores, setScores] = React.useState({ E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 });
      const [showNameForm, setShowNameForm] = React.useState(false);
      const [result, setResult] = React.useState(null);
      const [adventurerName, setAdventurerName] = React.useState('');

      const handleAnswer = (value, dimension) => {
        setScores((prev) => ({ ...prev, [value]: prev[value] + 1 }));
        if (currentQuestion < questions.length - 1) {
          setCurrentQuestion(currentQuestion + 1);
        } else {
          setShowNameForm(true);
        }
      };

      const handleNameSubmit = (name) => {
        const mbtiType = determineMBTI(scores);
        setResult(realmMappings[mbtiType] || "Sorin");
        setAdventurerName(name);
        setShowNameForm(false);
      };

      const determineMBTI = (scores) => {
        const ei = scores.E >= scores.I ? "E" : "I";
        const sn = scores.S >= scores.N ? "S" : "N";
        const tf = scores.T >= scores.F ? "T" : "F";
        const jp = scores.J >= scores.P ? "J" : "P";
        return `${ei}${sn}${tf}${jp}`;
      };

      const shareOnX = () => {
        const text = encodeURIComponent(`I got ${result} in the Ataraxia Realm Quiz! Discover your realm at https://shelmasahayam.github.io/ataraxiaquiz/`);
        window.open(`https://x.com/intent/tweet?text=${text}`, '_blank');
      };

      const shareOnInstagram = () => {
        html2canvas(document.getElementById('result-card')).then((canvas) => {
          const link = document.createElement('a');
          link.download = `ataraxia-result-${result.toLowerCase().replace(' ', '-')}.png`;
          link.href = canvas.toDataURL('image/png');
          link.click();
          alert('Image downloaded! Open Instagram on your mobile device, create a post or story, and upload the image to share your result.');
        }).catch((error) => {
          console.error('html2canvas error:', error);
          alert('Failed to generate image. Please try again or share manually.');
        });
      };

      const getSigilImage = (realm) => {
        try {
          return `https://shelmasahayam.github.io/ataraxiaquiz/assets/sigil-${realm.toLowerCase().replace(' ', '-')}.png`;
        } catch (e) {
          console.error(`Sigil image for ${realm} not found`);
          return 'https://shelmasahayam.github.io/ataraxiaquiz/assets/sigil-sorin.png';
        }
      };

      if (showNameForm) {
        return React.createElement(NameForm, { onSubmit: handleNameSubmit });
      }

      if (result) {
        return React.createElement(
          'div',
          { className: 'quiz-container cursor-quill' },
          React.createElement(
            'div',
            { id: 'result-card' },
            React.createElement('h2', { className: 'subtitle' }, `Welcome, ${adventurerName}, to ${result}!`),
            React.createElement('p', { className: 'result-text' }, realmDescriptions[result]),
            React.createElement('img', {
              src: getSigilImage(result),
              alt: `${result} Sigil`,
              style: { width: '128px', height: '128px', margin: '0 auto 24px' },
              onError: (e) => (e.target.src = 'https://shelmasahayam.github.io/ataraxiaquiz/assets/sigil-sorin.png')
            })
          ),
          React.createElement(
            'div',
            { className: 'button-container' },
            React.createElement('button', { onClick: shareOnX, className: 'share-button-x' }, 'Share on X'),
            React.createElement('button', { onClick: shareOnInstagram, className: 'share-button-instagram' }, 'Share on Instagram')
          )
        );
      }

      const question = questions[currentQuestion];

      return React.createElement(
        'div',
        { className: 'quiz-container cursor-quill' },
        React.createElement('h1', { className: 'title' }, 'Discover Your Ataraxia Realm'),
        React.createElement(ProgressBar, { current: currentQuestion + 1, total: questions.length }),
        React.createElement('h2', { className: 'question-text' }, question.text),
        React.createElement(
          'div',
          { style: { display: 'grid', gap: '16px' } },
          question.options.map((option, index) =>
            React.createElement(
              'button',
              {
                key: index,
                onClick: () => handleAnswer(option.value, question.dimension),
                className: 'option-button'
              },
              option.text
            )
          )
        )
      );
    };

    const App = () => {
      return React.createElement(
        'div',
        { style: { minHeight: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center' } },
        React.createElement(Quiz)
      );
    };

    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
  <!-- Brevo Validation Script -->
  <script>
    window.REQUIRED_CODE_ERROR_MESSAGE = 'Please choose a country code';
    window.LOCALE = 'en';
    window.EMAIL_INVALID_MESSAGE = window.SMS_INVALID_MESSAGE = "The information provided is invalid. Please review the field format and try again.";
    window.REQUIRED_ERROR_MESSAGE = "This field cannot be left blank.";
    window.GENERIC_INVALID_MESSAGE = "The information provided is invalid. Please review the field format and try again.";
    window.translation = {
      common: {
        selectedList: '{quantity} list selected',
        selectedLists: '{quantity} lists selected',
        selectedOption: '{quantity} selected',
        selectedOptions: '{quantity} selected',
      }
    };
    var AUTOHIDE = Boolean(1);
  </script>
  <script defer src="https://sibforms.com/forms/end-form/build/main.js"></script>
</body>
</html>

